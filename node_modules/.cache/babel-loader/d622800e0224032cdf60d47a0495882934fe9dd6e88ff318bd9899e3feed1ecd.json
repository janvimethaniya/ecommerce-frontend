{"ast":null,"code":"var _jsxFileName = \"D:\\\\new mern stack\\\\react\\\\project4\\\\ecommerce\\\\src\\\\Context\\\\Shopcontext.jsx\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ShopContext = /*#__PURE__*/createContext(null);\n\n// Default empty cart generator\nconst getDefaultCart = () => {\n  const cart = {};\n  for (let i = 1; i <= 200; i++) {\n    cart[i] = {\n      qty: 0,\n      size: \"\"\n    };\n  }\n  return cart;\n};\nconst ShopContextProvider = ({\n  children\n}) => {\n  _s();\n  const [products, setProducts] = useState([]); // all products\n  const [cartItems, setCartItems] = useState(getDefaultCart());\n\n  // Clear Cart function\n  const clearCart = () => {\n    const newCart = getDefaultCart();\n    setCartItems(newCart);\n    if (localStorage.getItem(\"auth-token\")) {\n      // Reset cart in backend too\n      fetch(\"http://localhost:7000/getcart\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"auth-token\": localStorage.getItem(\"auth-token\")\n        },\n        body: JSON.stringify({})\n      });\n    }\n  };\n\n  // ==========================\n  // FETCH ALL PRODUCTS\n  // ==========================\n  useEffect(() => {\n    fetch(\"http://localhost:7000/allproducts\").then(res => res.json()).then(data => setProducts(data)).catch(err => console.log(\"Fetch Products Error:\", err));\n\n    // Fetch saved cart if logged in\n    if (localStorage.getItem(\"auth-token\")) {\n      fetch(\"http://localhost:7000/getcart\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"auth-token\": localStorage.getItem(\"auth-token\")\n        },\n        body: \"\"\n      }).then(res => res.json()).then(data => setCartItems(data)).catch(err => console.log(\"Cart Fetch Error:\", err));\n    }\n  }, []);\n\n  // ==========================\n  // CART ACTIONS\n  // ==========================\n  const addToCart = itemId => {\n    setCartItems(prev => ({\n      ...prev,\n      [itemId]: {\n        qty: prev[itemId].qty + 1,\n        size: prev[itemId].size\n      }\n    }));\n    if (localStorage.getItem(\"auth-token\")) {\n      fetch(\"http://localhost:7000/addtocart\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"auth-token\": localStorage.getItem(\"auth-token\")\n        },\n        body: JSON.stringify({\n          itemId\n        })\n      });\n    }\n  };\n  const addToCartWithSize = (id, size) => {\n    setCartItems(prev => {\n      const existing = prev[id] || {\n        qty: 0,\n        size: size\n      };\n      return {\n        ...prev,\n        [id]: {\n          qty: existing.qty + 1,\n          size: size\n        }\n      };\n    });\n  };\n  const removeFromCart = itemId => {\n    setCartItems(prev => ({\n      ...prev,\n      [itemId]: {\n        qty: Math.max(prev[itemId].qty - 1, 0),\n        size: prev[itemId].size\n      }\n    }));\n    if (localStorage.getItem(\"auth-token\")) {\n      fetch(\"http://localhost:7000/removefromcart\", {\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"auth-token\": localStorage.getItem(\"auth-token\")\n        },\n        body: JSON.stringify({\n          itemId\n        })\n      });\n    }\n  };\n  const setItemQuantity = (itemId, qty) => {\n    const value = Math.max(0, Number(qty) || 0);\n    setCartItems(prev => ({\n      ...prev,\n      [itemId]: {\n        qty: value,\n        size: prev[itemId].size\n      }\n    }));\n  };\n  const deleteFromCart = itemId => {\n    setCartItems(prev => ({\n      ...prev,\n      [itemId]: {\n        qty: 0,\n        size: \"\"\n      }\n    }));\n  };\n\n  // ==========================\n  // TOTAL CART CALCULATIONS\n  // ==========================\n  const getTotalCartAmount = () => {\n    let total = 0;\n    for (let id in cartItems) {\n      if (cartItems[id].qty > 0) {\n        const product = products.find(p => p.id === id);\n        if (product) total += product.new_price * cartItems[id].qty;\n      }\n    }\n    return total;\n  };\n  const getTotalItems = () => {\n    let count = 0;\n    for (let id in cartItems) count += cartItems[id].qty;\n    return count;\n  };\n  const contextValue = {\n    all_product: products,\n    cartItems,\n    addToCart,\n    addToCartWithSize,\n    removeFromCart,\n    setItemQuantity,\n    deleteFromCart,\n    getTotalCartAmount,\n    getTotalItems,\n    clearCart\n  };\n  return /*#__PURE__*/_jsxDEV(ShopContext.Provider, {\n    value: contextValue,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 10\n  }, this);\n};\n_s(ShopContextProvider, \"st77IRJgAXSsZe/h+JTNeaHqcSA=\");\n_c = ShopContextProvider;\nexport default ShopContextProvider;\nvar _c;\n$RefreshReg$(_c, \"ShopContextProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","jsxDEV","_jsxDEV","ShopContext","getDefaultCart","cart","i","qty","size","ShopContextProvider","children","_s","products","setProducts","cartItems","setCartItems","clearCart","newCart","localStorage","getItem","fetch","method","headers","Accept","body","JSON","stringify","then","res","json","data","catch","err","console","log","addToCart","itemId","prev","addToCartWithSize","id","existing","removeFromCart","Math","max","setItemQuantity","value","Number","deleteFromCart","getTotalCartAmount","total","product","find","p","new_price","getTotalItems","count","contextValue","all_product","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/new mern stack/react/project4/ecommerce/src/Context/Shopcontext.jsx"],"sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\r\n\r\nexport const ShopContext = createContext(null);\r\n\r\n// Default empty cart generator\r\nconst getDefaultCart = () => {\r\n  const cart = {};\r\n  for (let i = 1; i <= 200; i++) {\r\n    cart[i] = { qty: 0, size: \"\" };\r\n  }\r\n  return cart;\r\n};\r\n\r\nconst ShopContextProvider = ({ children }) => {\r\n  const [products, setProducts] = useState([]); // all products\r\n  const [cartItems, setCartItems] = useState(getDefaultCart());\r\n\r\n  // Clear Cart function\r\n  const clearCart = () => {\r\n    const newCart = getDefaultCart();\r\n    setCartItems(newCart);\r\n\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      // Reset cart in backend too\r\n      fetch(\"http://localhost:7000/getcart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n          \"auth-token\": localStorage.getItem(\"auth-token\"),\r\n        },\r\n        body: JSON.stringify({}),\r\n      });\r\n    }\r\n  };\r\n\r\n  // ==========================\r\n  // FETCH ALL PRODUCTS\r\n  // ==========================\r\n  useEffect(() => {\r\n    fetch(\"http://localhost:7000/allproducts\")\r\n      .then((res) => res.json())\r\n      .then((data) => setProducts(data))\r\n      .catch((err) => console.log(\"Fetch Products Error:\", err));\r\n\r\n    // Fetch saved cart if logged in\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      fetch(\"http://localhost:7000/getcart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n          \"auth-token\": localStorage.getItem(\"auth-token\"),\r\n        },\r\n        body: \"\",\r\n      })\r\n        .then((res) => res.json())\r\n        .then((data) => setCartItems(data))\r\n        .catch((err) => console.log(\"Cart Fetch Error:\", err));\r\n    }\r\n  }, []);\r\n\r\n  // ==========================\r\n  // CART ACTIONS\r\n  // ==========================\r\n  const addToCart = (itemId) => {\r\n    setCartItems((prev) => ({\r\n      ...prev,\r\n      [itemId]: { qty: prev[itemId].qty + 1, size: prev[itemId].size },\r\n    }));\r\n\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      fetch(\"http://localhost:7000/addtocart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n          \"auth-token\": localStorage.getItem(\"auth-token\"),\r\n        },\r\n        body: JSON.stringify({ itemId }),\r\n      });\r\n    }\r\n  };\r\n\r\n  const addToCartWithSize = (id, size) => {\r\n    setCartItems((prev) => {\r\n      const existing = prev[id] || { qty: 0, size: size };\r\n      return {\r\n        ...prev,\r\n        [id]: {\r\n          qty: existing.qty + 1,\r\n          size: size,\r\n        },\r\n      };\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (itemId) => {\r\n    setCartItems((prev) => ({\r\n      ...prev,\r\n      [itemId]: { qty: Math.max(prev[itemId].qty - 1, 0), size: prev[itemId].size },\r\n    }));\r\n\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      fetch(\"http://localhost:7000/removefromcart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"Content-Type\": \"application/json\",\r\n          \"auth-token\": localStorage.getItem(\"auth-token\"),\r\n        },\r\n        body: JSON.stringify({ itemId }),\r\n      });\r\n    }\r\n  };\r\n\r\n  const setItemQuantity = (itemId, qty) => {\r\n    const value = Math.max(0, Number(qty) || 0);\r\n    setCartItems((prev) => ({\r\n      ...prev,\r\n      [itemId]: { qty: value, size: prev[itemId].size },\r\n    }));\r\n  };\r\n\r\n  const deleteFromCart = (itemId) => {\r\n    setCartItems((prev) => ({\r\n      ...prev,\r\n      [itemId]: { qty: 0, size: \"\" },\r\n    }));\r\n  };\r\n\r\n  // ==========================\r\n  // TOTAL CART CALCULATIONS\r\n  // ==========================\r\n  const getTotalCartAmount = () => {\r\n    let total = 0;\r\n    for (let id in cartItems) {\r\n      if (cartItems[id].qty > 0) {\r\n        const product = products.find((p) => p.id === id);\r\n        if (product) total += product.new_price * cartItems[id].qty;\r\n      }\r\n    }\r\n    return total;\r\n  };\r\n\r\n  const getTotalItems = () => {\r\n    let count = 0;\r\n    for (let id in cartItems) count += cartItems[id].qty;\r\n    return count;\r\n  };\r\n\r\n  const contextValue = {\r\n    all_product: products,\r\n    cartItems,\r\n    addToCart,\r\n    addToCartWithSize,\r\n    removeFromCart,\r\n    setItemQuantity,\r\n    deleteFromCart,\r\n    getTotalCartAmount,\r\n    getTotalItems,\r\n    clearCart,\r\n  };\r\n\r\n  return <ShopContext.Provider value={contextValue}>{children}</ShopContext.Provider>;\r\n};\r\n\r\nexport default ShopContextProvider;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}