{"ast":null,"code":"import _objectSpread from\"D:/new mern stack/react/project4/ecommerce/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import'./myOrder.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MyOrders=()=>{const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[expandedOrder,setExpandedOrder]=useState(null);const[orderEntries,setOrderEntries]=useState({});/* ================= FETCH MY ORDERS ================= */const fetchMyOrders=async()=>{try{const res=await fetch('http://localhost:7000/my-orders',{headers:{'auth-token':localStorage.getItem('auth-token')}});const data=await res.json();if(data.success){setOrders(data.orders);}setLoading(false);}catch(err){console.error(err);setLoading(false);}};useEffect(()=>{fetchMyOrders();},[]);/* ================= FETCH TRACKING ================= */const fetchTracking=async orderId=>{const res=await fetch(\"http://localhost:7000/order-entries/\".concat(orderId));const data=await res.json();setOrderEntries(prev=>_objectSpread(_objectSpread({},prev),{},{[orderId]:data}));};/* ================= HELPERS ================= */const formatDate=d=>new Date(d).toLocaleString('en-IN');const getStatusColor=status=>{switch(status){case'order_placed':return'#2874f0';case'processing':return'#ff9f00';case'packed':return'#8e24aa';case'shipped':return'#1976d2';case'out_for_delivery':return'#f57c00';case'delivered':return'#31a049';case'cancelled':return'#d32f2f';default:return'#666';}};if(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"loading\",children:\"Loading your orders...\"});if(!orders.length){return/*#__PURE__*/_jsx(\"p\",{className:\"empty\",children:\"You have not placed any orders yet.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"myorders-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDED2 My Orders\"}),orders.map(order=>{var _orderEntries$order$_;return/*#__PURE__*/_jsxs(\"div\",{className:\"myorder-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"myorder-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Order ID:\"}),\" \",order._id.slice(-8)]}),/*#__PURE__*/_jsx(\"p\",{className:\"date\",children:formatDate(order.date)})]}),/*#__PURE__*/_jsx(\"span\",{className:\"status-badge\",style:{background:getStatusColor(order.status)},children:order.status.replace(/_/g,' ').toUpperCase()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"items\",children:order.cartItems.map((item,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"item\",children:[item.image&&/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"name\",children:item.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Qty: \",item.quantity]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u20B9\",item.new_price]})]})]},i))}),/*#__PURE__*/_jsxs(\"div\",{className:\"total\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Total:\"}),\" \\u20B9\",order.totalAmount]}),/*#__PURE__*/_jsx(\"button\",{className:\"track-btn\",onClick:()=>{if(expandedOrder===order._id){setExpandedOrder(null);}else{setExpandedOrder(order._id);if(!orderEntries[order._id]){fetchTracking(order._id);}}},children:expandedOrder===order._id?'Hide Tracking â–²':'Track Order â–¼'}),expandedOrder===order._id&&/*#__PURE__*/_jsx(\"div\",{className:\"tracking-box\",children:(_orderEntries$order$_=orderEntries[order._id])!==null&&_orderEntries$order$_!==void 0&&_orderEntries$order$_.length?orderEntries[order._id].map((t,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"track-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"dot\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"action\",children:t.action.replace(/_/g,' ')}),/*#__PURE__*/_jsx(\"p\",{className:\"desc\",children:t.description}),/*#__PURE__*/_jsx(\"p\",{className:\"time\",children:formatDate(t.timestamp)}),t.notes&&/*#__PURE__*/_jsxs(\"p\",{className:\"note\",children:[\"Note: \",t.notes]})]})]},i)):/*#__PURE__*/_jsx(\"p\",{children:\"No tracking updates yet.\"})})]},order._id);})]});};export default MyOrders;","map":{"version":3,"names":["React","useEffect","useState","jsx","_jsx","jsxs","_jsxs","MyOrders","orders","setOrders","loading","setLoading","expandedOrder","setExpandedOrder","orderEntries","setOrderEntries","fetchMyOrders","res","fetch","headers","localStorage","getItem","data","json","success","err","console","error","fetchTracking","orderId","concat","prev","_objectSpread","formatDate","d","Date","toLocaleString","getStatusColor","status","className","children","length","map","order","_orderEntries$order$_","_id","slice","date","style","background","replace","toUpperCase","cartItems","item","i","image","src","alt","name","quantity","new_price","totalAmount","onClick","t","action","description","timestamp","notes"],"sources":["D:/new mern stack/react/project4/ecommerce/src/Component/myorder/MyOrders.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport './myOrder.css'\r\n\r\nconst MyOrders= () => {\r\n  const [orders, setOrders] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [expandedOrder, setExpandedOrder] = useState(null)\r\n  const [orderEntries, setOrderEntries] = useState({})\r\n\r\n  /* ================= FETCH MY ORDERS ================= */\r\n  const fetchMyOrders = async () => {\r\n    try {\r\n      const res = await fetch('http://localhost:7000/my-orders', {\r\n        headers: {\r\n          'auth-token': localStorage.getItem('auth-token')\r\n        }\r\n      })\r\n      const data = await res.json()\r\n      if (data.success) {\r\n        setOrders(data.orders)\r\n      }\r\n      setLoading(false)\r\n    } catch (err) {\r\n      console.error(err)\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchMyOrders()\r\n  }, [])\r\n\r\n  /* ================= FETCH TRACKING ================= */\r\n  const fetchTracking = async (orderId) => {\r\n    const res = await fetch(`http://localhost:7000/order-entries/${orderId}`)\r\n    const data = await res.json()\r\n    setOrderEntries(prev => ({ ...prev, [orderId]: data }))\r\n  }\r\n\r\n  /* ================= HELPERS ================= */\r\n  const formatDate = (d) =>\r\n    new Date(d).toLocaleString('en-IN')\r\n\r\n  const getStatusColor = (status) => {\r\n    switch (status) {\r\n      case 'order_placed': return '#2874f0'\r\n      case 'processing': return '#ff9f00'\r\n      case 'packed': return '#8e24aa'\r\n      case 'shipped': return '#1976d2'\r\n      case 'out_for_delivery': return '#f57c00'\r\n      case 'delivered': return '#31a049'\r\n      case 'cancelled': return '#d32f2f'\r\n      default: return '#666'\r\n    }\r\n  }\r\n\r\n  if (loading) return <p className=\"loading\">Loading your orders...</p>\r\n\r\n  if (!orders.length) {\r\n    return <p className=\"empty\">You have not placed any orders yet.</p>\r\n  }\r\n\r\n  return (\r\n    <div className=\"myorders-container\">\r\n      <h2>ðŸ›’ My Orders</h2>\r\n\r\n      {orders.map(order => (\r\n        <div key={order._id} className=\"myorder-card\">\r\n\r\n          {/* HEADER */}\r\n          <div className=\"myorder-header\">\r\n            <div>\r\n              <p><b>Order ID:</b> {order._id.slice(-8)}</p>\r\n              <p className=\"date\">{formatDate(order.date)}</p>\r\n            </div>\r\n\r\n            <span\r\n              className=\"status-badge\"\r\n              style={{ background: getStatusColor(order.status) }}\r\n            >\r\n              {order.status.replace(/_/g, ' ').toUpperCase()}\r\n            </span>\r\n          </div>\r\n\r\n          {/* ITEMS */}\r\n          <div className=\"items\">\r\n            {order.cartItems.map((item, i) => (\r\n              <div key={i} className=\"item\">\r\n                {item.image && <img src={item.image} alt={item.name} />}\r\n                <div>\r\n                  <p className=\"name\">{item.name}</p>\r\n                  <p>Qty: {item.quantity}</p>\r\n                  <p>â‚¹{item.new_price}</p>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* TOTAL */}\r\n          <div className=\"total\">\r\n            <b>Total:</b> â‚¹{order.totalAmount}\r\n          </div>\r\n\r\n          {/* TRACK BUTTON */}\r\n          <button\r\n            className=\"track-btn\"\r\n            onClick={() => {\r\n              if (expandedOrder === order._id) {\r\n                setExpandedOrder(null)\r\n              } else {\r\n                setExpandedOrder(order._id)\r\n                if (!orderEntries[order._id]) {\r\n                  fetchTracking(order._id)\r\n                }\r\n              }\r\n            }}\r\n          >\r\n            {expandedOrder === order._id ? 'Hide Tracking â–²' : 'Track Order â–¼'}\r\n          </button>\r\n\r\n          {/* TRACKING */}\r\n          {expandedOrder === order._id && (\r\n            <div className=\"tracking-box\">\r\n              {orderEntries[order._id]?.length ? (\r\n                orderEntries[order._id].map((t, i) => (\r\n                  <div key={i} className=\"track-item\">\r\n                    <span className=\"dot\"></span>\r\n                    <div>\r\n                      <p className=\"action\">{t.action.replace(/_/g, ' ')}</p>\r\n                      <p className=\"desc\">{t.description}</p>\r\n                      <p className=\"time\">{formatDate(t.timestamp)}</p>\r\n                      {t.notes && <p className=\"note\">Note: {t.notes}</p>}\r\n                    </div>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p>No tracking updates yet.</p>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default MyOrders\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}